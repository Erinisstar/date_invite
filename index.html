<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  
  // Sprite 設定
  const sprite = new Image();
  sprite.src = 'walker_sprite.png';
  const totalFrames = 3;
  const spriteSheetWidth = 1024;
  const spriteSheetHeight = 1024;
  const frameWidth = spriteSheetWidth / totalFrames;
  const frameHeight = spriteSheetHeight;
  
  // 地圖設定
  const bg = new Image();
  bg.src = 'taiwan_map.png'; // 請使用一張長型地圖
  let bgY = 0; // 地圖 Y 軸位移
  
  // 畫面中角色固定位置
  const charX = canvas.width / 2 - frameWidth / 4;
  const charY = canvas.height / 2 - frameHeight / 4;
  
  let frameIndex = 0;
  let frameCount = 0;
  let isMoving = false;
  
  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  
    // 畫背景地圖
    ctx.drawImage(bg, 0, bgY, canvas.width, canvas.height, 0, 0, canvas.width, canvas.height);
  
    // 畫角色
    if (isMoving) {
      frameCount++;
      if (frameCount % 10 === 0) {
        frameIndex = (frameIndex + 1) % totalFrames;
      }
    } else {
      frameIndex = 0;
    }
  
    ctx.drawImage(
      sprite,
      frameIndex * frameWidth, 0,
      frameWidth, frameHeight,
      charX, charY,
      frameWidth / 2, frameHeight / 2
    );
  
    requestAnimationFrame(draw);
  }
  
  document.addEventListener('keydown', (e) => {
    const step = 10;
    if (e.key === 'ArrowUp') {
      isMoving = true;
      if (bgY > 0) bgY -= step;
    } else if (e.key === 'ArrowDown') {
      isMoving = true;
      if (bgY < bg.height - canvas.height) bgY += step;
    }
  });
  
  document.addEventListener('keyup', (e) => {
    if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
      isMoving = false;
      frameCount = 0;
    }
  });
  
  bg.onload = () => {
    sprite.onload = draw;
  };
  </script>
  